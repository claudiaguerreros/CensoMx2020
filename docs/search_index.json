[["index.html", "Exploración datos Censo México 2020 Capítulo 1 Importación de datos cartográficos 1.1 Cambio de acceso estatal en: 1.2 Para determinar las variables e indicadores 1.3 Importación de datos censales 1.4 Graficación de todas las variables 1.5 POBTOT", " Exploración datos Censo México 2020 Claudia Guerrero 2021-11-09 Capítulo 1 Importación de datos cartográficos **Marco Geoestadístico El Marco Geoestadístico es un sistema único y de carácter nacional diseñado por el INEGI, el cual presenta la división del territorio nacional en diferentes niveles de desagregación para referir geográficamente la información estadística de los censos y encuestas institucionales y de las Unidades del Estado, que se integra al Sistema Nacional de Información Estadística y Geográfica (SNIEG). https://inegi.org.mx/temas/mg/#Descargas Contenido Mapa con las coordenadas estatles. Marco Geoestadístico, septiembre 2019 2019 3.11 GB https://inegi.org.mx/contenidos/productos//prod_serv/contenidos/espanol/bvinegi/productos/geografia/marcogeo/889463776079_s.zip Ficha de información. https://inegi.org.mx/app/biblioteca/ficha.html?upc=889463776079 Los nombres de archivos se conforman con las claves 00 y la capa con sufijos descriptivos del contenido del archivo: Donde: 00ent Polígonos de Áreas Geoestadísticas Estatales 00mun Polígonos de Áreas Municipales 00a Polígonos de Áreas Geoestadísticas Básicas Urbanas y Rurales 00l Polígonos de Localidades Urbanas y Rurales amanzanadas 00lpr Puntos de Localidades Rurales amanzanadas y no amanzanadas Marco Geoestadístico. Censo de Población y Vivienda 2020 2020 2.65 GB https://inegi.org.mx/contenidos/productos//prod_serv/contenidos/espanol/bvinegi/productos/geografia/marcogeo/889463807469_s.zip 1.1 Cambio de acceso estatal en: https://www.inegi.org.mx/programas/ccpv/2020/default.html#Datos_abiertos Ficha de información https://inegi.org.mx/app/biblioteca/ficha.html?upc=889463807469 Se descarga y se descomprime localmente Se crea una carpeta para los datos geográficos #La ruta para el mapa de México se toma del Marcogeostadístico nacional rutam&lt;-&quot;D:/Documents/Claudia/Midropbox/Investigacion y escritos/Marcogeoestadisticonacional/mg_sep2019_integrado/conjunto_de_datos&quot; #Lectura del mapa a nivel de entidades basemapan &lt;- readOGR(rutam,&quot;00ent&quot;, use_iconv = TRUE, encoding = &quot;latin1&quot;) ## OGR data source with driver: ESRI Shapefile ## Source: &quot;D:\\Documents\\Claudia\\Midropbox\\Investigacion y escritos\\Marcogeoestadisticonacional\\mg_sep2019_integrado\\conjunto_de_datos&quot;, layer: &quot;00ent&quot; ## with 32 features ## It has 3 fields #presentación de la información de las entidades tm_shape(basemapan) + tm_polygons(col = &quot;MAP_COLORS&quot;, minimize = TRUE) 1.2 Para determinar las variables e indicadores En el sitio https://www.inegi.org.mx/programas/ccpv/2020/default.html#Datos_abiertos Se descarga de los Principales resultados por localidad (ITER) el de los Estados Unidos Mexicanos 2020\" que es un archivo comprimido con el nombre de iter_00_cpv2020_csv.zip Cuando se descomprime en la carpeta del diccionario_datos se encuentra el archivo con el nombre de diccionario_datos_iter_00CSV20.csv Se creó un archivo con las variable para poderlas parametrizar en un archivo que lleva el nombre de variablescensales.csv #La ruta para el archivo que tiene las variables censales y su descripción rutvar&lt;-&quot;D:/Documents/Claudia/Midropbox/Investigacion y escritos&quot; variablescensales&lt;-read.csv(paste0(rutvar,&quot;/Censo2020/&quot;,&quot;variablescensales.csv&quot;),header=TRUE, sep=&quot;,&quot;,encoding=&quot;UTF-8&quot;) str(variablescensales) ## &#39;data.frame&#39;: 5 obs. of 6 variables: ## $ X.U.FEFF.numero: int 1 2 3 4 41 ## $ indicador : chr &quot;Población total&quot; &quot;Población femenina&quot; &quot;Población masculina&quot; &quot;Población de 0 a 2 años&quot; ... ## $ descripcion : chr &quot;Total de personas que residen habitualmente en el país, la entidad federativa, el municipio o la demarcación te&quot;| __truncated__ &quot;Total de mujeres que residen habitualmente en el país, la entidad federativa, el municipio o la demarcación ter&quot;| __truncated__ &quot;Total de hombres que residen habitualmente en el país, la entidad federativa, el municipio o la demarcación ter&quot;| __truncated__ &quot;Personas de 0 a 2 años de edad.&quot; ... ## $ mnemonico : chr &quot;POBTOT&quot; &quot;POBFEM&quot; &quot;POBMAS&quot; &quot;P_0A2&quot; ... ## $ rangos : chr &quot;0...999999999&quot; &quot;0...999999999&quot; &quot;0...999999999&quot; &quot;0...999999999&quot; ... ## $ longitud : int 9 9 9 9 9 1.3 Importación de datos censales En el sitio del INEGI se encuentran los resultados del CENSO 2020 para cada una de las entidades de la población https://www.inegi.org.mx/programas/ccpv/2020/default.html#Datos_abiertos Principales resultados por localidad (ITER) Estados Unidos Mexicanos 2020 https://www.inegi.org.mx/contenidos/programas/ccpv/2020/datosabiertos/iter/iter_00_cpv2020_csv.zip Para recuperar los datos censales a nivel estatal: En el archivo se registra la población total de la entidad cuando en el nombre de la localidad aparece la leyenda Total de la Entidad esto se puede observar al descomprimirlo. url&lt;-paste0(&quot;https://www.inegi.org.mx/contenidos/programas/ccpv/2020/datosabiertos/iter/iter_00_cpv2020_csv.zip&quot;) temp &lt;- tempfile() temp2 &lt;- tempfile() download.file(url, temp) unzip(zipfile = temp, exdir = temp2) rut&lt;-file.path(temp2) censonal&lt;- read.csv(paste0(rut,&quot;/&quot;,&quot;conjunto_de_datos/conjunto_de_datos_iter_00CSV20.csv&quot;),header=TRUE, sep=&quot;,&quot;,encoding=&quot;UTF-8&quot;) censonalo&lt;-censonal #Datos de toda la entidad uso del campo nom_loc para identificar los valores de las variables a nivel estatal censonal &lt;-subset(censonal,censonal$NOM_LOC %in% c(&quot;Total de la Entidad&quot;)) #Se le da nombre de CVE_ENT al primer atributo de la tabla censonal names(censonal)[1] &lt;- &quot;CVE_ENT&quot; #Ahora el mapa tiene el dato de las 198 variables del censo #Conversión a número #Se obtiene el mismo atributo CVE_ENT del marco geoestadístico codent&lt;-substr(basemapan$CVE_ENT,1,2) # Se convierte en un dato alfanumérico de dos digito como &quot;01&quot;, &quot;02&quot;,...&quot;32&quot; latmx=&quot;México&quot; codent&lt;-sprintf(&quot;%02d%s&quot;, as.numeric(gsub(&quot;[^0-9]+&quot;, &quot;&quot;, codent)), gsub(&quot;[0-9]+&quot;, &quot;&quot;, codent)) #Se agrega el campo CVE_ENT al censo censonal$CVE_ENT&lt;-codent #Se extraen las columnas que contienen las variables censales para convertirlas a valores numéricas de tipo entero. cols = c(11:231) censonal[,cols] %&lt;&gt;% lapply(function(x) as.integer(as.character(x))) #Se integra el valor censal con el marco geoestadísto a través de la llave de la entidad CVE_ENT basemapa&lt;-merge(basemapan,censonal, by=&quot;CVE_ENT&quot;, all.x =TRUE) 1.4 Graficación de todas las variables En el archivo \"mplotVariableparametrizadanacional.R se encuentran las instucciones para graficar, y se ejecuta el proceso para las variables que se encuentran el el archivo variablescensales.csv source(&quot;mplotVariableparametrizadanacional.R&quot;) variablescensales %&gt;% pull(mnemonico) %&gt;% as.character()%&gt;% walk(mplotVariableparametrizadanacional) 1.5 POBTOT Total de personas que residen habitualmente en el país, la entidad federativa, el municipio o la demarcación territorial y la localidad. Incluye la estimación del número de personas en viviendas particulares sin información de ocupantes. Incluye a la población que no especificó su edad. ## POBFEM Total de mujeres que residen habitualmente en el país, la entidad federativa, el municipio o la demarcación territorial y la localidad. Incluye la estimación del número de mujeres en viviendas particulares sin información de ocupantes. Incluye a la población que no especificó su edad. ## POBMAS Total de hombres que residen habitualmente en el país, la entidad federativa, el municipio o la demarcación territorial y la localidad. Incluye la estimación del número de hombres en viviendas particulares sin información de ocupantes. Incluye a la población que no especificó su edad. ## P_0A2 Personas de 0 a 2 años de edad. ## P_60YMAS Personas de 60 a 130 años de edad. 1.5.1 Video Este proceso se detalla en el siguiente video Y este es el código del script. mplotVariableparametrizadanacional.R mplotVariableparametrizadanacional &lt;-function(varname){ glue(\" ## {varname} \") %&gt;% cat() varindi&lt;-variablescensales[variablescensales$mnemonico == {varname}, descripcion] glue::glue (\" {varindi} \") %&gt;% cat() mapa&lt;-tm_shape(basemapa) + tm_polygons({varname}, fill=as.numeric({varname}), style=jenks, palette=YlOrBr, title= paste0({varname},\" ,latmx), alpha = 0.5) + tm_scale_bar(position = c(right,bottom)) + tm_layout(legend.position = c(right,top\"),asp=1 ,scale=0.5) print(mapa) cat() } "],["tratamiento-de-las-variables-del-censo.html", "Capítulo 2 Tratamiento de las variables del censo 2.1 Representación en mapas, el estilo seleccionado está relacionado con la definición de los rangos que se grafican 2.2 Variable y sus gráficas 2.3 Video", " Capítulo 2 Tratamiento de las variables del censo Se puede seleccionar alguna de las variables del censo para llevar a cabo el tratamiento de la misma, su representación espacial o el análisis descriptivo de sus valores. Se utiliza como parámetros alguna de las variables, para ejemplificar utilizaremos la población de 60 años y más 2.1 Representación en mapas, el estilo seleccionado está relacionado con la definición de los rangos que se grafican varname &lt;- c(&quot;P_60YMAS&quot;) estilo&lt;-c(&quot;pretty&quot;) entidad&lt;-c(&quot;Coahuila de Zaragoza&quot;) municipio&lt;-c(&quot;Torreón&quot;) indicad&lt;-c(&quot;Indenv65&quot;) params &lt;- data.frame(varname,estilo,entidad,municipio,indicad) tmap_mode(&quot;plot&quot;) varindi&lt;-variablescensales[variablescensales$mnemonico == params$varname, &quot;indicador&quot;] vardesc&lt;-variablescensales[variablescensales$mnemonico == params$varname, &quot;descripcion&quot;] glue::glue (&quot; {varindi} \\n &quot;) %&gt;% cat() ## Población de 60 años y más 2.1.1 Pretty glue(&quot;El estilo pretty redondea y divide en números enteros siempre que sea posible y los espacia uniformemente. \\n \\n &quot;) %&gt;% cat() ## El estilo pretty redondea y divide en números enteros siempre que sea posible y los espacia uniformemente. ## tm_shape(basemapa) + tm_polygons(params$varname) 2.1.2 Quantile glue(&quot;El estilo quantile crea rangos con un igual número de poligonos (estados) \\n \\n &quot;) %&gt;% cat() ## El estilo quantile crea rangos con un igual número de poligonos (estados) ## tm_shape(basemapa) + tm_fill(params$varname,palette=c(&quot;yellow&quot;,&quot;orange&quot;,&quot;red&quot;,&quot;green&quot;,&quot;blue&quot;), style =&quot;quantile&quot;)+ tm_borders()+ tm_layout(legend.position = c(&quot;right&quot;, &quot;bottom&quot;)) 2.1.3 Fisher glue(&quot;El estilo fisher crea grupos con la máxima homogeneidad \\n \\n &quot;) %&gt;% cat() ## El estilo fisher crea grupos con la máxima homogeneidad ## tm_shape(basemapa) + tm_fill(params$varname,palette=&quot;YlOrRd&quot;, style =&quot;fisher&quot;)+ tm_borders()+ tm_layout(legend.outside = FALSE, legend.outside.position = &quot;right&quot;,inner.margins = c(0.06, 0.10, 0.10, 0.08)) 2.1.4 Equal glue(&quot;El estilo equal divide los valores en rangos de igual ancho \\n \\n &quot;) %&gt;% cat() ## El estilo equal divide los valores en rangos de igual ancho ## tm_shape(basemapa) + tm_fill(params$varname,palette=&quot;YlOrRd&quot;, style =&quot;equal&quot;)+ tm_borders()+ tm_layout(legend.outside = TRUE, legend.outside.position = &quot;right&quot;) 2.1.5 Fixed glue(&quot;El fixed divide los valores en rangos de igual ancho \\n \\n &quot;) %&gt;% cat() ## El fixed divide los valores en rangos de igual ancho ## tm_shape(basemapa) + tm_fill(params$varname,palette=&quot;Blues&quot;, style =&quot;fixed&quot;,breaks = c(100000,200000,300000,400000,500000, 600000,700000, 800000))+ tm_borders() tmap_mode(&quot;plot&quot;) tm_shape(basemapa) + tm_fill(params$varname,title={varindi},legend.hist=TRUE ,n = 8) + tm_borders()+ tm_layout(legend.outside = TRUE, legend.outside.position = &quot;right&quot;)+ tm_layout(title = paste0({vardesc}, &quot; censo 2020&quot;), title.size = 0.8, title.position = c(&quot;right&quot;,&quot;bottom&quot;)) #tmap_mode(&quot;view&quot;) 2.1.6 Sd Desviación Estándar glue(&quot;El estilo sd calcula la desviación estándar de la variable y la usa como valor para el ancho de los rangos. \\n \\n &quot;) %&gt;% cat() ## El estilo sd calcula la desviación estándar de la variable y la usa como valor para el ancho de los rangos. ## tm_shape(basemapa) + tm_fill(params$varname,title={varindi},alpha=0.7,style=&quot;sd&quot;,palette=&quot;Blues&quot;,id=&quot;NOM_ENT&quot;) + tm_borders() + tm_basemap(server=&quot;OpenStreetMap&quot;,alpha=0.5)+ tm_layout(legend.outside = FALSE, legend.outside.position = &quot;right&quot;,inner.margins = c(0.06, 0.10, 0.10, 0.08)) 2.1.7 Kmeans medias glue(&quot;El estilo kmeans utiliza la media de la variable y la usa como valor para el ancho de los rangos. \\n \\n &quot;) %&gt;% cat() ## El estilo kmeans utiliza la media de la variable y la usa como valor para el ancho de los rangos. ## tm_shape(basemapa) + tm_fill(params$varname,title={varindi},alpha=0.7,style=&quot;kmeans&quot;,palette=&quot;Blues&quot;,id=&quot;NOM_ENT&quot;) + tm_borders() + tm_basemap(server=&quot;OpenStreetMap&quot;,alpha=0.5)+ tm_layout(legend.outside = TRUE, legend.outside.position = &quot;right&quot;) 2.1.8 Representación bubbles tmap_mode(&quot;plot&quot;) glue(&quot; \\n## params$varname \\n \\n &quot;) %&gt;% cat() ## ## params$varname ## varindi&lt;-variablescensales[variablescensales$mnemonico == params$varname, &quot;indicador&quot;] vardesc&lt;-variablescensales[variablescensales$mnemonico == params$varname, &quot;descripcion&quot;] glue::glue (&quot; {varindi} \\n &quot;) %&gt;% cat() ## Población de 60 años y más tm_shape(basemapa) + tm_bubbles(size=params$varname, col= params$varname, style =&quot;kmeans&quot;, n=6, palette =&quot;RdYlBu&quot;,id=&quot;NOM_ENT&quot;)+ tm_borders() tmap_mode(&quot;plot&quot;) 2.2 Variable y sus gráficas basic.stats &lt;- function(dset, vars){ for(i in 1:length(vars)){ print(vars[i]) gg&lt;-ggplot(data=dset, aes(x = dset$NOM_ENT, y = dset[[vars[i]]])) + coord_flip()+ geom_bar(stat=&quot;identity&quot;, fill = &quot;#FF6666&quot;) + ylab(params$varname) + xlab(&quot;&quot;) print(gg) print(summary(dset[[vars[i]]])) print(quantile(dset[[vars[i]]],c(0,.01,.1,.5,.9,.99,1))) } } 2.2.1 Estadísticas básicas basic.stats(censonal, c(params$varname)) ## [1] &quot;P_60YMAS&quot; ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 75608 207053 370451 473218 563358 1919454 ## 0% 1% 10% 50% 90% 99% 100% ## 75608.00 80552.19 132484.40 370450.50 973718.40 1786825.15 1919454.00 2.3 Video Este proceso se detalla en el siguiente video "],["variables-parametrizadas-al-ejecutar.html", "Capítulo 3 Variables parametrizadas al ejecutar 3.1 Código en el que se ejecuta el script maptwitter.Rmd 3.2 P_60YMAS 3.3 Video", " Capítulo 3 Variables parametrizadas al ejecutar El siguiente texto ejemplifica la ejecución del código seleccionando la variable que se quiere estudiar Los parámetros se seleccionan en la ejecución cómo se muestra en el video final title: Variable cartografiada author: Claudia Guerrero S date: 07/02/2021 output: html_document: df_print: paged pdf_document: default params: #=======================# # Render Function: # #=======================# estilo: label: &quot;Estilo&quot; value: jenks input: select choices: [pretty,equal,quantile,sd,kmeans,jenks,fisher] varname: label: &quot;Variable&quot; value: P_60YMAS input: select choices: [POBTOT,POBFEM,POBMAS,P_0A2,P_0A2_F,P_0A2_M,P_3YMAS,P_3YMAS_F,P_3YMAS_M,P_5YMAS,P_5YMAS_F,P_5YMAS_M,P_12YMAS,P_12YMAS_F,P_12YMAS_M,P_15YMAS,P_15YMAS_F,P_15YMAS_M,P_18YMAS,P_18YMAS_F,P_18YMAS_M,P_3A5,P_3A5_F,P_3A5_M,P_6A11] 3.1 Código en el que se ejecuta el script maptwitter.Rmd ```{r include=FALSE, echo = FALSE, message = FALSE, warning=FALSE} rmarkdown::render(maptwitter.Rmd, params = ask) # ``` ## Código script maptwitter.Rmd #knitr::opts_chunk$set(echo = FALSE) #La ruta para el mapa de México se toma del Marcogeostadístico nacional #rutam&lt;-&quot;D:/Documents/Claudia/Midropbox/Investigacion y escritos/Marcogeoestadisticonacional/mg_sep2019_integrado/conjunto_de_datos&quot; #basemapan &lt;- readOGR(rutam,&quot;00ent&quot;, use_iconv = TRUE, encoding = &quot;latin1&quot;) #La ruta para el archivo que tiene las variables censales y su descripción #rutvar&lt;-&quot;D:/Documents/Claudia/Midropbox/Investigacion y escritos&quot; #variablescensales&lt;-read.csv(paste0(rutvar,&quot;/Censo2020/&quot;,&quot;variablescensales.csv&quot;),header=TRUE, sep=&quot;,&quot;,encoding=&quot;UTF-8&quot;) ## Importación de datos cartográficos a&lt;-unique( variablescensales$mnemonico) print(a) ## [1] &quot;POBTOT&quot; &quot;POBFEM&quot; &quot;POBMAS&quot; &quot;P_0A2&quot; &quot;P_60YMAS&quot; #url&lt;-paste0(&quot;https://www.inegi.org.mx/contenidos/programas/ccpv/2020/datosabiertos/iter/iter_00_cpv2020_csv.zip&quot;) #temp &lt;- tempfile() #temp2 &lt;- tempfile() #download.file(url, temp) #unzip(zipfile = temp, exdir = temp2) #rut&lt;-file.path(temp2) #censonal&lt;- read.csv(paste0(rut,&quot;/&quot;,&quot;conjunto_de_datos/conjunto_de_datos_iter_00CSV20.csv&quot;),header=TRUE, sep=&quot;,&quot;,encoding=&quot;UTF-8&quot;) #Datos de toda la entidad uso del campo nom_loc para identificar los valores de las variables a nivel estatal censonal &lt;-subset(censonalo,censonalo$NOM_LOC %in% c(&quot;Total de la Entidad&quot;)) names(censonal)[1] &lt;- &quot;CVE_ENT&quot; #Ahora el mapa tiene el dato de las 198 variables del censo #Conversión a número codent&lt;-substr(basemapan$CVE_ENT,1,2) latmx=&quot;México&quot; codent&lt;-sprintf(&quot;%02d%s&quot;, as.numeric(gsub(&quot;[^0-9]+&quot;, &quot;&quot;, codent)), gsub(&quot;[0-9]+&quot;, &quot;&quot;, codent)) censonal$CVE_ENT&lt;-codent cols = c(11:231) censonal[,cols] %&lt;&gt;% lapply(function(x) as.integer(as.character(x))) basemapa&lt;-merge(basemapan,censonal, by=&quot;CVE_ENT&quot;, all.x =TRUE) tmap_mode(&quot;plot&quot;) desc&lt;-case_when( params$estilo == &quot;pretty&quot; ~ &quot;El estilo pretty redondea y divide en números enteros siempre que sea posible y los espacia uniformemente. \\n \\n &quot;, params$estilo == &quot;equal&quot; ~ &quot;El estilo equal divide los valores en rangos de igual ancho \\n \\n &quot;, params$estilo == &quot;quantile&quot; ~ &quot;El estilo quantile crea rangos con un igual número de poligonos (estados) \\n \\n &quot;, params$estilo == &quot;sd&quot; ~ &quot;El estilo sd calcula la desviación estándar de la variable y la usa como valor para el ancho de los rangos. \\n \\n &quot;, params$estilo == &quot;kmeans&quot; ~ &quot;El estilo kmeans utiliza la media de la variable y la usa como valor para el ancho de los rangos. \\n \\n &quot;, params$estilo == &quot;jenks&quot; ~ &quot;El estilo jenks identifica grupos de valores similares y maximiza la diferencia entre categorías. \\n \\n &quot;, params$estilo == &quot;fisher&quot; ~ &quot;El estilo fisher crea grupos con la máxima homogeneidad \\n \\n &quot;) glue(&quot; \\n## &quot;,params$varname,&quot; \\n \\n &quot;) %&gt;% cat() 3.2 P_60YMAS varindi&lt;-variablescensales[variablescensales$mnemonico == params$varname, &quot;indicador&quot;] vardesc&lt;-variablescensales[variablescensales$mnemonico == params$varname, &quot;descripcion&quot;] glue::glue (&quot; {varindi} \\n\\n&quot;) %&gt;% cat() Población de 60 años y más glue(&quot;\\n\\n&quot;) ## one newline glue::glue (&quot; {desc} \\n\\n&quot;) %&gt;% cat() El estilo pretty redondea y divide en números enteros siempre que sea posible y los espacia uniformemente. mapi&lt;-tm_shape(basemapa) + tm_fill(params$varname,title=params$varname,legend.hist=TRUE ,n = 8,id=&quot;NOM_ENT&quot;,palette=&quot;RdYlBu&quot;,style=params$estilo) + tm_borders()+ tm_layout(legend.outside = TRUE, legend.outside.position = &quot;right&quot;)+ tm_layout(title = paste0({vardesc}, &quot; censo 2020&quot;), title.size = 0.5, title.position = c(&quot;right&quot;,&quot;bottom&quot;)) mapi #mapi&lt;-tm_shape(basemapa) + #tm_bubbles(size=params$varname, #col= params$varname, style =&quot;kmeans&quot;, n=6, #palette =&quot;RdYlBu&quot;,id=&quot;NOM_ENT&quot;)+ #tm_borders() #mapi tmap_mode(&quot;plot&quot;) 3.3 Video Este proceso se detalla en el siguiente video "],["variable-cartografiada-por-entidad.html", "Capítulo 4 Variable cartografiada por entidad 4.1 Datos cartográficos nivel municipal 4.2 Importación de datos censales 4.3 Variables en la entidad,mapa nacional 4.4 Mapa de la entidad 4.5 Variables en el mapa de la entidad 4.6 Video", " Capítulo 4 Variable cartografiada por entidad El siguiente texto ejemplifica la ejecución del código seleccionando la variable que se quiere estudiar Los parámetros se seleccionan en la ejecución cómo se muestra en el video final  title: Variable cartografiada por entidad author: Claudia Guerrero S date: 17/02/2021 output: html_document: df_print: paged pdf_document: default params: #=======================# # Render Function: # #=======================# estilo: label: Estilo value: jenks input: select choices: [pretty,equal,quantile,sd,kmeans,jenks,fisher] varname: label: Variable value: P_60YMAS input: select choices: [POBTOT,POBFEM,POBMAS,P_0A2,P_0A2_F,P_0A2_M,P_3YMAS,P_3YMAS_F,P_3YMAS_M,P_5YMAS,P_5YMAS_F,P_5YMAS_M,P_12YMAS] entidad: label: Entidad Federativa value: Coahuila de Zaragoza input: select choices: [Aguascalientes,Baja California,Baja California Sur,Campeche,Coahuila de Zaragoza,Colima,Chiapas,Chihuahua,Ciudad de México,Durango,Guanajuato,Guerrero,Hidalgo,Jalisco,México,Michoacán de Ocampo,Morelos,Nayarit,Nuevo León,Oaxaca,Puebla,Querétaro,Quintana Roo,San Luis Potosí,Sinaloa,Sonora,Tabasco,Tamaulipas,Tlaxcala,Veracruz de Ignacio de la Llave,Yucatán,Zacatecas]  4.1 Datos cartográficos nivel municipal https://www.inegi.org.mx/contenidos/productos/prod_serv/contenidos/espanol/bvinegi/productos/geografia/marcogeo/889463807469_s.zip Marco Geoestadístico. Censo de Población y Vivienda 2020 2020 2.65 GB https://inegi.org.mx/contenidos/productos//prod_serv/contenidos/espanol/bvinegi/productos/geografia/marcogeo/889463807469_s.zip Ficha de información https://inegi.org.mx/app/biblioteca/ficha.html?upc=889463807469 Se descarga y se descomprime localmente Se crea una carpeta para los datos geográficos #La ruta para el mapa de México se toma del Marcogeostadístico nacional rutam&lt;-&quot;D:/Documents/Claudia/Midropbox/Investigacion y escritos/Marcogeoestadisticonacional/mg_sep2019_integrado/conjunto_de_datos&quot; basemapan &lt;- readOGR(rutam,&quot;00mun&quot;, use_iconv = TRUE, encoding = &quot;latin1&quot;) ## OGR data source with driver: ESRI Shapefile ## Source: &quot;D:\\Documents\\Claudia\\Midropbox\\Investigacion y escritos\\Marcogeoestadisticonacional\\mg_sep2019_integrado\\conjunto_de_datos&quot;, layer: &quot;00mun&quot; ## with 2465 features ## It has 4 fields tm_shape(basemapan) + tm_polygons(col = &quot;MAP_COLORS&quot;, minimize = TRUE) #La ruta para el archivo que tiene las variables censales y su descripción #rutvar&lt;-&quot;D:/Documents/Claudia/Midropbox/Investigacion y escritos&quot; #variablescensales&lt;-read.csv(paste0(rutvar,&quot;/Censo2020/&quot;,&quot;variablescensales.csv&quot;),header=TRUE, sep=&quot;,&quot;,encoding=&quot;UTF-8&quot;) ## Importación de datos cartográficos 4.2 Importación de datos censales En el sitio del INEGI se encuentran los resultados del CENSO 2020 para cada una de las entidades de la población https://www.inegi.org.mx/programas/ccpv/2020/default.html#Datos_abiertos Principales resultados por localidad (ITER) Estados Unidos Mexicanos 2020 https://www.inegi.org.mx/contenidos/programas/ccpv/2020/datosabiertos/iter/iter_00_cpv2020_csv.zip Para recuperar los datos censales a nivel estatal: En el archivo se registra la población total de la entidad cuando en el nombre de la localidad aparece la leyenda Total de la Entidad #url&lt;-paste0(&quot;https://www.inegi.org.mx/contenidos/programas/ccpv/2020/datosabiertos/iter/iter_00_cpv2020_csv.zip&quot;) #temp &lt;- tempfile() #temp2 &lt;- tempfile() #download.file(url, temp) #unzip(zipfile = temp, exdir = temp2) #rut&lt;-file.path(temp2) #censonal&lt;- read.csv(paste0(rut,&quot;/&quot;,&quot;conjunto_de_datos/conjunto_de_datos_iter_00CSV20.csv&quot;),header=TRUE, sep=&quot;,&quot;,encoding=&quot;UTF-8&quot;) censonal&lt;-censonalo names(censonal)[1] &lt;- &quot;CVE_ENT&quot; #Datos de toda la entidad uso del campo nom_loc para identificar los valores de las variables a nivel estatal latmx=&quot;México&quot; codent&lt;-substr(censonal$CVE_ENT,1,2) codent&lt;-sprintf(&quot;%02d%s&quot;, as.numeric(gsub(&quot;[^0-9]+&quot;, &quot;&quot;, codent)), gsub(&quot;[0-9]+&quot;, &quot;&quot;, codent)) codmun&lt;-substr(censonal$MUN,1,3) codmun&lt;-sprintf(&quot;%03d%s&quot;, as.numeric(gsub(&quot;[^0-9]+&quot;, &quot;&quot;, codmun)), gsub(&quot;[0-9]+&quot;, &quot;&quot;, codent)) censonal$CVEGEO&lt;-paste0(codent,codmun) censonal &lt;-subset(censonal,censonal$NOM_ENT %in% c(params$entidad)) censonal &lt;-subset(censonal,censonal$NOM_LOC %in% c(&quot;Total del Municipio&quot;)) #Ahora el mapa tiene el dato de las 198 variables del censo #Conversión a número cols = c(11:231) censonal[,cols] %&lt;&gt;% lapply(function(x) as.integer(as.character(x))) basemapa&lt;-merge(basemapan,censonal,by=&quot;CVEGEO&quot;, all.x =TRUE) 4.3 Variables en la entidad,mapa nacional tmap_mode(&quot;plot&quot;) desc&lt;-case_when( params$estilo == &quot;pretty&quot; ~ &quot;El estilo pretty redondea y divide en números enteros siempre que sea posible y los espacia uniformemente. \\n \\n &quot;, params$estilo == &quot;equal&quot; ~ &quot;El estilo equal divide los valores en rangos de igual ancho \\n \\n &quot;, params$estilo == &quot;quantile&quot; ~ &quot;El estilo quantile crea rangos con un igual número de poligonos (estados) \\n \\n &quot;, params$estilo == &quot;sd&quot; ~ &quot;El estilo sd calcula la desviación estándar de la variable y la usa como valor para el ancho de los rangos. \\n \\n &quot;, params$estilo == &quot;kmeans&quot; ~ &quot;El estilo kmeans utiliza la media de la variable y la usa como valor para el ancho de los rangos. \\n \\n &quot;, params$estilo == &quot;jenks&quot; ~ &quot;El estilo jenks identifica grupos de valores similares y maximiza la diferencia entre categorías. \\n \\n &quot;, params$estilo == &quot;fisher&quot; ~ &quot;El estilo fisher crea grupos con la máxima homogeneidad \\n \\n &quot;) #glue(&quot; \\n## &quot;,params$varname,&quot; \\n \\n &quot;) %&gt;% cat() glue(params$varname,&quot; \\n \\n &quot;) %&gt;% cat() P_60YMAS varindi&lt;-variablescensales[variablescensales$mnemonico == params$varname, &quot;indicador&quot;] vardesc&lt;-variablescensales[variablescensales$mnemonico == params$varname, &quot;descripcion&quot;] glue::glue (&quot; {varindi} \\n\\n&quot;) %&gt;% cat() Población de 60 años y más glue(&quot;\\n\\n&quot;) ## one newline glue::glue (&quot; {desc} \\n\\n&quot;) %&gt;% cat() El estilo pretty redondea y divide en números enteros siempre que sea posible y los espacia uniformemente. mapi&lt;-tm_shape(basemapa) + tm_fill(params$varname,title=params$varname,legend.hist=TRUE ,n = 8,id=&quot;NOM_MUN&quot;,palette=&quot;RdYlBu&quot;,style=params$estilo,convert2density = TRUE) + tm_borders()+ tm_layout(legend.outside = TRUE, legend.outside.position = &quot;right&quot;)+ tm_layout(title = paste0({vardesc}, &quot; censo 2020&quot;), title.size = 0.5, title.position = c(&quot;right&quot;,&quot;bottom&quot;)) mapi basic.stats &lt;- function(dset, vars){ for(i in 1:length(vars)){ print(vars[i]) gg&lt;-ggplot(data=dset, aes(x = dset$NOM_MUN, y = dset[[vars[i]]])) + coord_flip()+ geom_bar(stat=&quot;identity&quot;, fill = &quot;#FF6666&quot;) + ylab(params$varname) + xlab(&quot;&quot;) print(gg) glue(&quot; \\n## &quot;,&quot; \\n \\n \\n &quot;) %&gt;% cat() glue(&quot; \\n## &quot;,&quot; \\n \\n \\n &quot;) %&gt;% cat() print(summary(dset[[vars[i]]])) glue(&quot; \\n## &quot;,&quot; \\n \\n \\n &quot;) %&gt;% cat() glue(&quot; \\n## &quot;,&quot; \\n \\n \\n &quot;) %&gt;% cat() print(quantile(dset[[vars[i]]],c(0,.01,.1,.5,.9,.99,1))) glue(&quot; \\n## &quot;,&quot; \\n \\n &quot;) %&gt;% cat() } } basic.stats(censonal, c(params$varname)) [1] P_60YMAS ## ## Min. 1st Qu. Median Mean 3rd Qu. Max. 201.0 618.5 2669.5 9172.0 7966.5 89453.0 ## ## 0% 1% 10% 50% 90% 99% 100% 201.00 209.88 295.10 2669.50 14211.30 88746.30 89453.00 ## tmap_mode(&quot;plot&quot;) 4.4 Mapa de la entidad Se creó un archivo con la información del nombre del archivo para cade entidad, este archivo se llama y el contenido lo podemos tener en la tabla geoentidades Y así la base del mapa será el de la entidad rutamc&lt;-&quot;D:/Documents/Claudia/Midropbox/Investigacion y escritos/Censo2020/&quot; geoentidades&lt;-read.csv(paste0(rutamc,&quot;marcogeoentidad.csv&quot;),header=TRUE, sep=&quot;,&quot;,encoding=&quot;UTF-8&quot;) glue(&quot;\\n\\n&quot;) ## one newline head(geoentidades,1) NUM_ENT NOM_ENT minent COD_ENT ARCHENT 1 1 Aguascalientes aguascalientes 1 01_aguascalientes glue(&quot;\\n\\n&quot;) ## one newline rutamc&lt;-&quot;D:/Documents/Claudia/Midropbox/Investigacion y escritos/Censo2020/889463807469_s&quot; codent&lt;-substr(geoentidades$NUM_ENT,1,2) codent&lt;-sprintf(&quot;%02d%s&quot;, as.numeric(gsub(&quot;[^0-9]+&quot;, &quot;&quot;, codent)), gsub(&quot;[0-9]+&quot;, &quot;&quot;, codent)) geoentidades$COD_ENT&lt;-codent geoentidades &lt;-subset(geoentidades,geoentidades$NOM_ENT %in% c(params$entidad)) rutamc&lt;-&quot;D:/Documents/Claudia/Midropbox/Investigacion y escritos/Censo2020/889463807469_s/&quot; filename&lt;-geoentidades$ARCHENT filemun&lt;-paste0(geoentidades$COD_ENT,&quot;mun&quot;) url&lt;-paste0(rutamc,filename,&quot;.zip&quot;) temp2 &lt;- tempfile() unzip(url, exdir = temp2) rut&lt;-file.path(temp2) rutamun&lt;-paste0(rut,&quot;/conjunto_de_datos&quot;) glue(&quot;\\n\\n&quot;) ## one newline basemapan &lt;- readOGR(rutamun,filemun, use_iconv = TRUE, encoding = &quot;latin1&quot;) OGR data source with driver: ESRI Shapefile Source: \"C:.Guerrero1d3842ba17b4_de_datos, layer:05mun\" with 38 features It has 4 fields tm_shape(basemapan) + tm_polygons(col = &quot;MAP_COLORS&quot;, minimize = TRUE) #La ruta para el archivo que tiene las variables censales y su descripción rutvar&lt;-&quot;D:/Documents/Claudia/Midropbox/Investigacion y escritos&quot; variablescensales&lt;-read.csv(paste0(rutvar,&quot;/Censo2020/&quot;,&quot;variablescensales.csv&quot;),header=TRUE, sep=&quot;,&quot;,encoding=&quot;UTF-8&quot;) censonal&lt;-censonalo names(censonal)[1] &lt;- &quot;CVE_ENT&quot; #Datos de toda la entidad uso del campo nom_loc para identificar los valores de las variables a nivel estatal latmx=&quot;México&quot; codent&lt;-substr(censonal$CVE_ENT,1,2) codent&lt;-sprintf(&quot;%02d%s&quot;, as.numeric(gsub(&quot;[^0-9]+&quot;, &quot;&quot;, codent)), gsub(&quot;[0-9]+&quot;, &quot;&quot;, codent)) codmun&lt;-substr(censonal$MUN,1,3) codmun&lt;-sprintf(&quot;%03d%s&quot;, as.numeric(gsub(&quot;[^0-9]+&quot;, &quot;&quot;, codmun)), gsub(&quot;[0-9]+&quot;, &quot;&quot;, codent)) censonal$CVEGEO&lt;-paste0(codent,codmun) censonal &lt;-subset(censonal,censonal$NOM_ENT %in% c(params$entidad)) censonal &lt;-subset(censonal,censonal$NOM_LOC %in% c(&quot;Total del Municipio&quot;)) #Ahora el mapa tiene el dato de las 198 variables del censo #Conversión a número cols = c(11:231) censonal[,cols] %&lt;&gt;% lapply(function(x) as.integer(as.character(x))) basemapa&lt;-merge(basemapan,censonal,by=&quot;CVEGEO&quot;, all.x =TRUE) 4.5 Variables en el mapa de la entidad P_60YMAS Población de 60 años y más El estilo pretty redondea y divide en números enteros siempre que sea posible y los espacia uniformemente. [1] P_60YMAS ## ## Min. 1st Qu. Median Mean 3rd Qu. Max. 201.0 618.5 2669.5 9172.0 7966.5 89453.0 ## ## 0% 1% 10% 50% 90% 99% 100% 201.00 209.88 295.10 2669.50 14211.30 88746.30 89453.00 ## 4.6 Video Este proceso se detalla en el siguiente video "],["variable-cartografiada-por-localidad.html", "Capítulo 5 Variable cartografiada por localidad 5.1 Importación de datos cartográficos 5.2 Importación de datos censales 5.3 Variables de la localidad en la entidad 5.4 Video", " Capítulo 5 Variable cartografiada por localidad El siguiente texto ejemplifica la ejecución del código seleccionando la variable que se quiere estudiar  title: Variable cartografiada por localidad author: Claudia Guerrero S date: 27/02/2021 output: html_document: df_print: paged pdf_document: default params: #=======================# # Render Function: # #=======================# estilo: label: Estilo value: jenks input: select choices: [pretty,equal,quantile,sd,kmeans,jenks,fisher] varname: label: Variable value: P_60YMAS input: select choices: [POBTOT,POBFEM,POBMAS,P_0A2,P_0A2_F,P_0A2_M,P_3YMAS,P_3YMAS_F,P_3YMAS_M,P_5YMAS,P_5YMAS_F,P_5YMAS_M,P_12YMAS,P_12YMAS_F,P_12YMAS_M,P_15YMAS,P_15YMAS_F,P_15YMAS_M,P_18YMAS,P_18YMAS_F,P_18YMAS_M,P_3A5,P_3A5_F,P_3A5_M] entidad: label: Entidad Federativa value: Jalisco input: select choices: [Aguascalientes,Baja California,Baja California Sur,Campeche,Coahuila de Zaragoza,Colima,Chiapas,Chihuahua,Ciudad de México,Durango,Guanajuato,Guerrero,Hidalgo,Jalisco,México,Michoacán de Ocampo,Morelos,Nayarit,Nuevo León,Oaxaca,Puebla,Querétaro,Quintana Roo,San Luis Potosí,Sinaloa,Sonora,Tabasco,Tamaulipas,Tlaxcala,Veracruz de Ignacio de la Llave,Yucatán,Zacatecas]  5.1 Importación de datos cartográficos https://www.inegi.org.mx/contenidos/productos/prod_serv/contenidos/espanol/bvinegi/productos/geografia/marcogeo/889463807469_s.zip Censo de Población y Vivienda 2020 2020 2.65 GB https://inegi.org.mx/contenidos/productos//prod_serv/contenidos/espanol/bvinegi/productos/geografia/marcogeo/889463807469_s.zip Ficha de información https://inegi.org.mx/app/biblioteca/ficha.html?upc=889463807469 Se descarga y se descomprime localmente y de ahí se obtiena la capa de la localidad #La ruta para el mapa de México se toma del Marcogeostadístico nacional rutam&lt;-&quot;D:/Documents/Claudia/Midropbox/Investigacion y escritos/Marcogeoestadisticonacional/mg_sep2019_integrado/conjunto_de_datos&quot; rutamc&lt;-&quot;D:/Documents/Claudia/Midropbox/Investigacion y escritos/Censo2020/&quot; geoentidades&lt;-read.csv(paste0(rutamc,&quot;marcogeoentidad.csv&quot;),header=TRUE, sep=&quot;,&quot;,encoding=&quot;UTF-8&quot;) rutamc&lt;-&quot;D:/Documents/Claudia/Midropbox/Investigacion y escritos/Censo2020/889463807469_s&quot; codent&lt;-substr(geoentidades$NUM_ENT,1,2) codent&lt;-sprintf(&quot;%02d%s&quot;, as.numeric(gsub(&quot;[^0-9]+&quot;, &quot;&quot;, codent)), gsub(&quot;[0-9]+&quot;, &quot;&quot;, codent)) geoentidades$COD_ENT&lt;-codent geoentidades &lt;-subset(geoentidades,geoentidades$NOM_ENT %in% c(params$entidad)) rutamc&lt;-&quot;D:/Documents/Claudia/Midropbox/Investigacion y escritos/Censo2020/889463807469_s/&quot; filename&lt;-geoentidades$ARCHENT filemun&lt;-paste0(geoentidades$COD_ENT,&quot;mun&quot;) fileloc&lt;-paste0(geoentidades$COD_ENT,&quot;l&quot;) url&lt;-paste0(rutamc,filename,&quot;.zip&quot;) temp2 &lt;- tempfile() unzip(url, exdir = temp2) rut&lt;-file.path(temp2) rutamun&lt;-paste0(rut,&quot;/conjunto_de_datos&quot;) basemapamun &lt;- readOGR(rutamun,filemun, use_iconv = TRUE, encoding = &quot;latin1&quot;) ## OGR data source with driver: ESRI Shapefile ## Source: &quot;C:\\Users\\Claudia.Guerrero\\AppData\\Local\\Temp\\RtmpmWrTxw\\file1d38339c79cf\\conjunto_de_datos&quot;, layer: &quot;05mun&quot; ## with 38 features ## It has 4 fields basemapaloc &lt;- readOGR(rutamun,fileloc, use_iconv = TRUE, encoding = &quot;latin1&quot;) ## OGR data source with driver: ESRI Shapefile ## Source: &quot;C:\\Users\\Claudia.Guerrero\\AppData\\Local\\Temp\\RtmpmWrTxw\\file1d38339c79cf\\conjunto_de_datos&quot;, layer: &quot;05l&quot; ## with 836 features ## It has 6 fields tm_shape(basemapamun) + tm_polygons(col = &quot;MAP_COLORS&quot;, palette = &quot;Spectral&quot;)+ tm_shape(basemapaloc) + tm_polygons(col = &quot;MAP_COLORS&quot;, minimize = TRUE) rutvar&lt;-&quot;D:/Documents/Claudia/Midropbox/Investigacion y escritos&quot; variablescensales&lt;-read.csv(paste0(rutvar,&quot;/Censo2020/&quot;,&quot;variablescensales.csv&quot;),header=TRUE, sep=&quot;,&quot;,encoding=&quot;UTF-8&quot;) 5.2 Importación de datos censales En el sitio del INEGI se encuentran los resultados del CENSO 2020 para cada una de las entidades de la población https://www.inegi.org.mx/programas/ccpv/2020/default.html#Datos_abiertos Principales resultados por localidad (ITER) Estados Unidos Mexicanos 2020 https://www.inegi.org.mx/contenidos/programas/ccpv/2020/datosabiertos/iter/iter_00_cpv2020_csv.zip Para recuperar los datos censales a nivel estatal: En el archivo se registra la población total de la entidad cuando en el nombre de la localidad aparece la leyenda Total de la Entidad #url&lt;-paste0(&quot;https://www.inegi.org.mx/contenidos/programas/ccpv/2020/datosabiertos/iter/iter_00_cpv2020_csv.zip&quot;) #temp &lt;- tempfile() #temp2 &lt;- tempfile() #download.file(url, temp) #unzip(zipfile = temp, exdir = temp2) #rut&lt;-file.path(temp2) censonal&lt;- censonalo names(censonal)[1] &lt;- &quot;CVE_ENT&quot; #Datos de toda la entidad uso del campo nom_loc para identificar los valores de las variables a nivel estatal latmx=&quot;México&quot; codent&lt;-substr(censonal$CVE_ENT,1,2) codent&lt;-sprintf(&quot;%02d%s&quot;, as.numeric(gsub(&quot;[^0-9]+&quot;, &quot;&quot;, codent)), gsub(&quot;[0-9]+&quot;, &quot;&quot;, codent)) codmun&lt;-substr(censonal$MUN,1,3) codmun&lt;-sprintf(&quot;%03d%s&quot;, as.numeric(gsub(&quot;[^0-9]+&quot;, &quot;&quot;, codmun)), gsub(&quot;[0-9]+&quot;, &quot;&quot;, codmun)) codloc&lt;-substr(censonal$LOC,1,4) codloc&lt;-sprintf(&quot;%04d%s&quot;, as.numeric(gsub(&quot;[^0-9]+&quot;, &quot;&quot;, codloc)), gsub(&quot;[0-9]+&quot;, &quot;&quot;, codloc)) censonal$CVEGEO&lt;-paste0(codent,codmun,codloc) #censonal &lt;-subset(censonal,censonal$NOM_LOC %in% c(&quot;Total del Municipio&quot;)) censonal &lt;-subset(censonal,censonal$NOM_ENT %in% c(params$entidad)) #Ahora el mapa tiene el dato de las 198 variables del censo #Conversión a número cols = c(11:231) censonal[,cols] %&lt;&gt;% lapply(function(x) as.integer(as.character(x))) basemapa&lt;-merge(basemapaloc,censonal, by=&quot;CVEGEO&quot;, all.x =TRUE) municipios&lt;-censonal$NOM_MUN data&lt;- unique(municipios) data(list=params$municipio) 5.3 Variables de la localidad en la entidad P_60YMAS Población de 60 años y más El estilo pretty redondea y divide en números enteros siempre que sea posible y los espacia uniformemente. 5.4 Video Este proceso se detalla en el siguiente video "],["variable-cartografiada-por-ageb.html", "Capítulo 6 Variable cartografiada por ageb 6.1 Importación de datos cartográficos 6.2 Importación de datos censales 6.3 Variable en las Agebs del municipio 6.4 Video", " Capítulo 6 Variable cartografiada por ageb El siguiente texto ejemplifica la ejecución del código seleccionando la variable que se quiere estudiar  title: Variable cartografiada por AGEB author: Claudia Guerrero S date: 27/02/2021 output: html_document: df_print: paged pdf_document: default params: #=======================# # Render Function: # #=======================# estilo: label: Estilo value: jenks input: select choices: [pretty,equal,quantile,sd,kmeans,jenks,fisher] varname: label: Variable value: P_60YMAS input: select choices: [POBTOT,POBFEM,POBMAS,P_0A2,P_0A2_F,P_0A2_M,P_3YMAS,P_3YMAS_F,P_3YMAS_M,P_5YMAS,P_5YMAS_F,P_5YMAS_M,P_12YMAS,P_12YMAS_F,P_12YMAS_M] entidad: label: Entidad Federativa value: Coahuila de Zaragoza input: select choices: [Aguascalientes,Baja California,Baja California Sur,Campeche,Coahuila de Zaragoza,Colima,Chiapas,Chihuahua,Ciudad de México,Durango,Guanajuato,Guerrero,Hidalgo,Jalisco,México,Michoacán de Ocampo,Morelos,Nayarit,Nuevo León,Oaxaca,Puebla,Querétaro,Quintana Roo,San Luis Potosí,Sinaloa,Sonora,Tabasco,Tamaulipas,Tlaxcala,Veracruz de Ignacio de la Llave,Yucatán,Zacatecas]  6.1 Importación de datos cartográficos https://www.inegi.org.mx/contenidos/productos/prod_serv/contenidos/espanol/bvinegi/productos/geografia/marcogeo/889463807469_s.zip Censo de Población y Vivienda 2020 2020 2.65 GB https://inegi.org.mx/contenidos/productos//prod_serv/contenidos/espanol/bvinegi/productos/geografia/marcogeo/889463807469_s.zip Ficha de información https://inegi.org.mx/app/biblioteca/ficha.html?upc=889463807469 Se localiza la capa de AGEB Se accede al archivo municipios.csv que tiene los nombres de los municipios por entidad #La ruta para el mapa de México se toma del Marcogeostadístico nacional rutam&lt;-&quot;D:/Documents/Claudia/Midropbox/Investigacion y escritos/Marcogeoestadisticonacional/mg_sep2019_integrado/conjunto_de_datos&quot; rutamc&lt;-&quot;D:/Documents/Claudia/Midropbox/Investigacion y escritos/Censo2020/&quot; geoentidades&lt;-read.csv(paste0(rutamc,&quot;marcogeoentidad.csv&quot;),header=TRUE, sep=&quot;,&quot;,encoding=&quot;UTF-8&quot;) municipios&lt;-read.csv(paste0(rutamc,&quot;municipios.csv&quot;),header=TRUE, sep=&quot;,&quot;,encoding=&quot;latin&quot;) rutamc&lt;-&quot;D:/Documents/Claudia/Midropbox/Investigacion y escritos/Censo2020/889463807469_s&quot; codent&lt;-substr(geoentidades$NUM_ENT,1,2) codent&lt;-sprintf(&quot;%02d%s&quot;, as.numeric(gsub(&quot;[^0-9]+&quot;, &quot;&quot;, codent)), gsub(&quot;[0-9]+&quot;, &quot;&quot;, codent)) geoentidades$COD_ENT&lt;-codent geoentidades &lt;-subset(geoentidades,geoentidades$NOM_ENT %in% c(params$entidad)) codent&lt;-geoentidades$COD_ENT municipios &lt;-subset(municipios,municipios$NOM_ENT %in% c(params$entidad)) municipios &lt;-subset(municipios,municipios$NOM_ENT %in% c(params$municipio)) rutamc&lt;-&quot;D:/Documents/Claudia/Midropbox/Investigacion y escritos/Censo2020/889463807469_s/&quot; filename&lt;-geoentidades$ARCHENT filemun&lt;-paste0(geoentidades$COD_ENT,&quot;mun&quot;) fileloc&lt;-paste0(geoentidades$COD_ENT,&quot;a&quot;) url&lt;-paste0(rutamc,filename,&quot;.zip&quot;) temp2 &lt;- tempfile() unzip(url, exdir = temp2) rut&lt;-file.path(temp2) rutamun&lt;-paste0(rut,&quot;/conjunto_de_datos&quot;) basemapamun &lt;- readOGR(rutamun,filemun, use_iconv = TRUE, encoding = &quot;latin1&quot;) ## OGR data source with driver: ESRI Shapefile ## Source: &quot;C:\\Users\\Claudia.Guerrero\\AppData\\Local\\Temp\\RtmpmWrTxw\\file1d3843892f84\\conjunto_de_datos&quot;, layer: &quot;05mun&quot; ## with 38 features ## It has 4 fields basemapaloc &lt;- readOGR(rutamun,fileloc, use_iconv = TRUE, encoding = &quot;latin1&quot;) ## OGR data source with driver: ESRI Shapefile ## Source: &quot;C:\\Users\\Claudia.Guerrero\\AppData\\Local\\Temp\\RtmpmWrTxw\\file1d3843892f84\\conjunto_de_datos&quot;, layer: &quot;05a&quot; ## with 1882 features ## It has 5 fields tm_shape(basemapamun) + tm_polygons(col = &quot;MAP_COLORS&quot;, palette = &quot;Spectral&quot;)+ tm_shape(basemapaloc) + tm_polygons(col = &quot;MAP_COLORS&quot;, minimize = TRUE) rutvar&lt;-&quot;D:/Documents/Claudia/Midropbox/Investigacion y escritos&quot; variablescensales&lt;-read.csv(paste0(rutvar,&quot;/Censo2020/&quot;,&quot;variablescensales.csv&quot;),header=TRUE, sep=&quot;,&quot;,encoding=&quot;UTF-8&quot;) 6.2 Importación de datos censales En el sitio del INEGI se encuentran los resultados del CENSO 2020 para cada una de las entidades de la población https://www.inegi.org.mx/programas/ccpv/2020/default.html#Datos_abiertos Principales resultados por AGEB y manzana urbana Ejemplo. Aguascaliente s https://www.inegi.org.mx/contenidos/programas/ccpv/2020/datosabiertos/ageb_manzana/ageb_mza_urbana_01_cpv2020_csv.zip Para recuperar los datos censales a nivel estatal: En el archivo se registra la población total de la entidad cuando en el nombre de la localidad aparece la leyenda Total de la Entidad codent&lt;-geoentidades$COD_ENT url&lt;-paste0(&quot;https://www.inegi.org.mx/contenidos/programas/ccpv/2020/datosabiertos/ageb_manzana/ageb_mza_urbana_&quot;,codent,&quot;_cpv2020_csv.zip&quot;) temp &lt;- tempfile() temp2 &lt;- tempfile() download.file(url, temp) unzip(zipfile = temp, exdir = temp2) rut&lt;-file.path(temp2) #filename&lt;-paste0(rut,&quot;/&quot;,&quot;conjunto_de_datos/conjunto_de_datos_ageb_urbana_&quot;,codent,&quot;_cpv2020.csv&quot;) filename&lt;-paste0(rut,&quot;/&quot;,&quot;ageb_mza_urbana_&quot;,codent,&quot;_cpv2020&quot;,&quot;/&quot;,&quot;conjunto_de_datos&quot;,&quot;/&quot;,&quot;conjunto_de_datos_ageb_urbana_&quot;,codent,&quot;_cpv2020.csv&quot;) censonal&lt;- read.csv(filename,header=TRUE, sep=&quot;,&quot;,encoding=&quot;UTF-8&quot;) names(censonal)[1] &lt;- &quot;CVE_ENT&quot; #Datos de toda la entidad uso del campo nom_loc para identificar los valores de las variables a nivel estatal latmx=&quot;México&quot; censonal &lt;-subset(censonal,censonal$NOM_LOC %in% c(&quot;Total AGEB urbana&quot;)) codent&lt;-substr(censonal$CVE_ENT,1,2) codent&lt;-sprintf(&quot;%02d%s&quot;, as.numeric(gsub(&quot;[^0-9]+&quot;, &quot;&quot;, codent)), gsub(&quot;[0-9]+&quot;, &quot;&quot;, codent)) codmun&lt;-substr(censonal$MUN,1,3) codmun&lt;-sprintf(&quot;%03d%s&quot;, as.numeric(gsub(&quot;[^0-9]+&quot;, &quot;&quot;, codmun)), gsub(&quot;[0-9]+&quot;, &quot;&quot;, codmun)) codloc&lt;-substr(censonal$LOC,1,4) codloc&lt;-sprintf(&quot;%04d%s&quot;, as.numeric(gsub(&quot;[^0-9]+&quot;, &quot;&quot;, codloc)), gsub(&quot;[0-9]+&quot;, &quot;&quot;, codloc)) codageb&lt;-substr(censonal$AGEB,1,4) censonal$CVEGEO&lt;-paste0(codent,codmun,codloc,codageb) # censonal &lt;-subset(censonal,censonal$NOM_ENT %in% #c(params$entidad)) #Ahora el mapa tiene el dato de las 198 variables del censo #Conversión a número cols = c(11:229) censonal[,cols] %&lt;&gt;% lapply(function(x) as.integer(as.character(x))) basemapa&lt;-merge(basemapaloc,censonal, by=&quot;CVEGEO&quot;, all.x =TRUE) 6.3 Variable en las Agebs del municipio Torreón P_60YMAS Población de 60 años y más El estilo pretty redondea y divide en números enteros siempre que sea posible y los espacia uniformemente. 6.4 Video Este proceso se detalla en el siguiente video "],["variable-cartografiada-por-manzana.html", "Capítulo 7 Variable cartografiada por manzana 7.1 Importación de datos cartográficos 7.2 Importación de datos censales 7.3 Variables y sus mapas nacionales 7.4 Video", " Capítulo 7 Variable cartografiada por manzana El siguiente texto ejemplifica la ejecución del código seleccionando la variable que se quiere estudiar  title: Variable cartografiada por manzana author: Claudia Guerrero S date: 5/03/2021 output: html_document: df_print: paged pdf_document: default params: #=======================# # Render Function: # #=======================# estilo: label: Estilo value: jenks input: select choices: [pretty,equal,quantile,sd,kmeans,jenks,fisher] varname: label: Variable value: P_60YMAS input: select choices: [POBTOT,POBFEM,POBMAS,P_0A2,P_0A2_F,P_0A2_M,P_3YMAS,P_3YMAS_F,P_3YMAS_M,P_5YMAS,P_5YMAS_F,P_5YMAS_M,P_12YMAS,P_12YMAS_F,P_12YMAS_M,P_15YMAS,P_15YMAS_F,P_15YMAS_M,P_18YMAS,P_18YMAS_F,P_18YMAS_M,P_3A5,P_3A5_FVPH_INTER,VPH_STVP,VPH_SPMVPI,VPH_CVJ] entidad: label: Entidad Federativa value: Coahuila de Zaragoza input: select choices: [Aguascalientes,Baja California,Baja California Sur,Campeche,Coahuila de Zaragoza,Colima,Chiapas,Chihuahua,Ciudad de México,Durango,Guanajuato,Guerrero,Hidalgo,Jalisco,México,Michoacán de Ocampo,Morelos,Nayarit,Nuevo León,Oaxaca,Puebla,Querétaro,Quintana Roo,San Luis Potosí,Sinaloa,Sonora,Tabasco,Tamaulipas,Tlaxcala,Veracruz de Ignacio de la Llave,Yucatán,Zacatecas] municipio: label: Municipio value: Torreón  7.1 Importación de datos cartográficos https://www.inegi.org.mx/contenidos/productos/prod_serv/contenidos/espanol/bvinegi/productos/geografia/marcogeo/889463807469_s.zip Censo de Población y Vivienda 2020 2020 2.65 GB https://inegi.org.mx/contenidos/productos//prod_serv/contenidos/espanol/bvinegi/productos/geografia/marcogeo/889463807469_s.zip Ficha de información https://inegi.org.mx/app/biblioteca/ficha.html?upc=889463807469 Se descarga y se descomprime localmente Se crea una carpeta para los datos geográficos #La ruta para el mapa de México se toma del Marcogeostadístico nacional rutam&lt;-&quot;D:/Documents/Claudia/Midropbox/Investigacion y escritos/Marcogeoestadisticonacional/mg_sep2019_integrado/conjunto_de_datos&quot; rutamc&lt;-&quot;D:/Documents/Claudia/Midropbox/Investigacion y escritos/Censo2020/&quot; geoentidades&lt;-read.csv(paste0(rutamc,&quot;marcogeoentidad.csv&quot;),header=TRUE, sep=&quot;,&quot;,encoding=&quot;UTF-8&quot;) municipios&lt;-read.csv(paste0(rutamc,&quot;municipios.csv&quot;),header=TRUE, sep=&quot;,&quot;,encoding=&quot;latin&quot;) municipios &lt;-subset(municipios,municipios$NOM_ENT %in% c(params$entidad)) municipios &lt;-subset(municipios,municipios$NOM_MUN %in% c(params$municipio)) titulmun&lt;-municipios$NOM_MUN nummun&lt;-municipios$MUN rutamc&lt;-&quot;D:/Documents/Claudia/Midropbox/Investigacion y escritos/Censo2020/889463807469_s&quot; codent&lt;-substr(geoentidades$NUM_ENT,1,2) codent&lt;-sprintf(&quot;%02d%s&quot;, as.numeric(gsub(&quot;[^0-9]+&quot;, &quot;&quot;, codent)), gsub(&quot;[0-9]+&quot;, &quot;&quot;, codent)) geoentidades$COD_ENT&lt;-codent geoentidades &lt;-subset(geoentidades,geoentidades$NOM_ENT %in% c(params$entidad)) codent&lt;-geoentidades$COD_ENT rutamc&lt;-&quot;D:/Documents/Claudia/Midropbox/Investigacion y escritos/Censo2020/889463807469_s/&quot; filename&lt;-geoentidades$ARCHENT filemun&lt;-paste0(geoentidades$COD_ENT,&quot;mun&quot;) fileloc&lt;-paste0(geoentidades$COD_ENT,&quot;a&quot;) filemza&lt;-paste0(geoentidades$COD_ENT,&quot;m&quot;) url&lt;-paste0(rutamc,filename,&quot;.zip&quot;) temp2 &lt;- tempfile() unzip(url, exdir = temp2) rut&lt;-file.path(temp2) rutamun&lt;-paste0(rut,&quot;/conjunto_de_datos&quot;) basemapamun &lt;- readOGR(rutamun,filemun, use_iconv = TRUE, encoding = &quot;latin1&quot;) ## OGR data source with driver: ESRI Shapefile ## Source: &quot;C:\\Users\\Claudia.Guerrero\\AppData\\Local\\Temp\\RtmpmWrTxw\\file1d385b904546\\conjunto_de_datos&quot;, layer: &quot;05mun&quot; ## with 38 features ## It has 4 fields snummun&lt;-sprintf(&quot;%03d%s&quot;, as.numeric(gsub(&quot;[^0-9]+&quot;, &quot;&quot;, nummun)), gsub(&quot;[0-9]+&quot;, &quot;&quot;, nummun)) basemapamun&lt;-subset(basemapamun,basemapamun$CVE_MUN %in% c(snummun)) basemapaloc &lt;- readOGR(rutamun,fileloc, use_iconv = TRUE, encoding = &quot;latin1&quot;) ## OGR data source with driver: ESRI Shapefile ## Source: &quot;C:\\Users\\Claudia.Guerrero\\AppData\\Local\\Temp\\RtmpmWrTxw\\file1d385b904546\\conjunto_de_datos&quot;, layer: &quot;05a&quot; ## with 1882 features ## It has 5 fields basemapaloc&lt;-subset(basemapaloc,basemapaloc$CVE_MUN %in% c(snummun)) basemapamza &lt;- readOGR(rutamun,filemza, use_iconv = TRUE, encoding = &quot;latin1&quot;) ## OGR data source with driver: ESRI Shapefile ## Source: &quot;C:\\Users\\Claudia.Guerrero\\AppData\\Local\\Temp\\RtmpmWrTxw\\file1d385b904546\\conjunto_de_datos&quot;, layer: &quot;05m&quot; ## with 75827 features ## It has 8 fields basemapamza&lt;-subset(basemapamza,basemapamza$CVE_MUN %in% c(snummun)) tm_shape(basemapamun) + tm_polygons(col = &quot;MAP_COLORS&quot;, minimize = FALSE) tm_shape(basemapaloc) + tm_polygons(col = &quot;MAP_COLORS&quot;, minimize = FALSE)+ tm_shape(basemapamza) + tm_polygons(col = &quot;MAP_COLORS&quot;, minimize = FALSE) rutvar&lt;-&quot;D:/Documents/Claudia/Midropbox/Investigacion y escritos&quot; variablescensales&lt;-read.csv(paste0(rutvar,&quot;/Censo2020/&quot;,&quot;variablescensales.csv&quot;),header=TRUE, sep=&quot;,&quot;,encoding=&quot;UTF-8&quot;) 7.2 Importación de datos censales En el sitio del INEGI se encuentran los resultados del CENSO 2020 para cada una de las entidades de la población https://www.inegi.org.mx/programas/ccpv/2020/default.html#Datos_abiertos Principales resultados por AGEB y manzana urbana Ejemplo. Aguascaliente s https://www.inegi.org.mx/contenidos/programas/ccpv/2020/datosabiertos/ageb_manzana/ageb_mza_urbana_01_cpv2020_csv.zip Para recuperar los datos censales a nivel estatal: En el archivo se registra la población total de la entidad cuando en el nombre de la localidad aparece la leyenda Total de la Entidad codent&lt;-geoentidades$COD_ENT url&lt;-paste0(&quot;https://www.inegi.org.mx/contenidos/programas/ccpv/2020/datosabiertos/ageb_manzana/ageb_mza_urbana_&quot;,codent,&quot;_cpv2020_csv.zip&quot;) temp &lt;- tempfile() temp2 &lt;- tempfile() download.file(url, temp) unzip(zipfile = temp, exdir = temp2) rut&lt;-file.path(temp2) filename&lt;-paste0(rut,&quot;/&quot;,&quot;ageb_mza_urbana_&quot;,codent,&quot;_cpv2020&quot;,&quot;/&quot;,&quot;conjunto_de_datos&quot;,&quot;/&quot;,&quot;conjunto_de_datos_ageb_urbana_&quot;,codent,&quot;_cpv2020.csv&quot;) censonal&lt;- read.csv(filename,header=TRUE, sep=&quot;,&quot;,encoding=&quot;UTF-8&quot;) names(censonal)[1] &lt;- &quot;CVE_ENT&quot; #Datos de toda la entidad uso del campo nom_loc para identificar los valores de las variables a nivel estatal censonal &lt;-subset(censonal,censonal$NOM_ENT %in% c(params$entidad)) censonal &lt;-subset(censonal,censonal$MUN %in% c(nummun)) `%notin%` &lt;- Negate(`%in%`) censonal &lt;-censonal[censonal$AGEB %notin% c(&quot;0000&quot;),] codent&lt;-substr(censonal$CVE_ENT,1,2) codent&lt;-sprintf(&quot;%02d%s&quot;, as.numeric(gsub(&quot;[^0-9]+&quot;, &quot;&quot;, codent)), gsub(&quot;[0-9]+&quot;, &quot;&quot;, codent)) codmun&lt;-substr(censonal$MUN,1,3) codmun&lt;-sprintf(&quot;%03d%s&quot;, as.numeric(gsub(&quot;[^0-9]+&quot;, &quot;&quot;, codmun)), gsub(&quot;[0-9]+&quot;, &quot;&quot;, codmun)) codloc&lt;-substr(censonal$LOC,1,4) codloc&lt;-sprintf(&quot;%04d%s&quot;, as.numeric(gsub(&quot;[^0-9]+&quot;, &quot;&quot;, codloc)), gsub(&quot;[0-9]+&quot;, &quot;&quot;, codloc)) codageb&lt;-substr(censonal$AGEB,1,4) codmza&lt;-substr(censonal$MZA,1,3) codmza&lt;-sprintf(&quot;%03d%s&quot;, as.numeric(gsub(&quot;[^0-9]+&quot;, &quot;&quot;, codmza)), gsub(&quot;[0-9]+&quot;, &quot;&quot;, codmza)) censonal$CVEGEO&lt;-paste0(codent,codmun,codloc,codageb,codmza) # censonal &lt;-subset(censonal,censonal$NOM_ENT %in% #c(params$entidad)) #Ahora el mapa tiene el dato de las 198 variables del censo #Conversión a número cols = c(11:229) censonal[,cols] %&lt;&gt;% lapply(function(x) as.integer(as.character(x))) #censonal$CVEGEO censonal[,cols] %&lt;&gt;% lapply(function(x) x/censonal$POBTOT) basemapa&lt;-merge(basemapamza,censonal, by=&quot;CVEGEO&quot;, all.x =TRUE) 7.3 Variables y sus mapas nacionales Torreón P_60YMAS Población de 60 años y más El estilo fisher crea grupos con la máxima homogeneidad 7.4 Video Este proceso se detalla en el siguiente video "],["variable-cartografiada-en-zona-seleccionada.html", "Capítulo 8 Variable cartografiada en zona seleccionada 8.1 Importación de datos cartográficos 8.2 Importación de datos censales 8.3 Variables en zona seleccionada 8.4 Video", " Capítulo 8 Variable cartografiada en zona seleccionada El siguiente texto ejemplifica la ejecución del código seleccionando la variable que se quiere estudiar  title: Variable cartografiada por manzana zona seleccionada author: Claudia Guerrero S date: 2/04/2021 output: html_document: df_print: paged pdf_document: default params: #=======================# # Render Function: # #=======================# estilo: label: Estilo value: jenks input: select choices: [pretty,equal,quantile,sd,kmeans,jenks,fisher] varname: label: Variable value: P_60YMAS input: select choices: [POBTOT,POBFEM,POBMAS,P_0A2,P_0A2_F,P_0A2_M,P_3YMAS,P_3YMAS_F,P_3YMAS_M,P_5YMAS,P_5YMAS_F,P_5YMAS_M,P_12YMAS,P_12YMAS_F,P_12YMAS_M,P_15YMAS,P_15YMAS_F,P_15YMAS_M,P_18YMAS] entidad: label: Entidad Federativa value: Coahuila de Zaragoza input: select choices: [Aguascalientes,Baja California,Baja California Sur,Campeche,Coahuila de Zaragoza,Colima,Chiapas,Chihuahua,Ciudad de México,Durango,Guanajuato,Guerrero,Hidalgo,Jalisco,México,Michoacán de Ocampo,Morelos,Nayarit,Nuevo León,Oaxaca,Puebla,Querétaro,Quintana Roo,San Luis Potosí,Sinaloa,Sonora,Tabasco,Tamaulipas,Tlaxcala,Veracruz de Ignacio de la Llave,Yucatán,Zacatecas] municipio: label: Municipio value: Torreón  8.1 Importación de datos cartográficos https://www.inegi.org.mx/contenidos/productos/prod_serv/contenidos/espanol/bvinegi/productos/geografia/marcogeo/889463807469_s.zip Censo de Población y Vivienda 2020 2020 2.65 GB https://inegi.org.mx/contenidos/productos//prod_serv/contenidos/espanol/bvinegi/productos/geografia/marcogeo/889463807469_s.zip Ficha de información https://inegi.org.mx/app/biblioteca/ficha.html?upc=889463807469 Se descarga y se descomprime localmente Se crea una carpeta para los datos geográficos #La ruta para el mapa de México se toma del Marcogeostadístico nacional rutam&lt;-&quot;D:/Documents/Claudia/Midropbox/Investigacion y escritos/Marcogeoestadisticonacional/mg_sep2019_integrado/conjunto_de_datos&quot; rutamc&lt;-&quot;D:/Documents/Claudia/Midropbox/Investigacion y escritos/Censo2020/&quot; geoentidades&lt;-read.csv(paste0(rutamc,&quot;marcogeoentidad.csv&quot;),header=TRUE, sep=&quot;,&quot;,encoding=&quot;UTF-8&quot;) municipios&lt;-read.csv(paste0(rutamc,&quot;municipios.csv&quot;),header=TRUE, sep=&quot;,&quot;,encoding=&quot;latin&quot;) municipios &lt;-subset(municipios,municipios$NOM_ENT %in% c(params$entidad)) municipios &lt;-subset(municipios,municipios$NOM_MUN %in% c(params$municipio)) titulmun&lt;-municipios$NOM_MUN nummun&lt;-municipios$MUN rutamc&lt;-&quot;D:/Documents/Claudia/Midropbox/Investigacion y escritos/Censo2020/889463807469_s&quot; codent&lt;-substr(geoentidades$NUM_ENT,1,2) codent&lt;-sprintf(&quot;%02d%s&quot;, as.numeric(gsub(&quot;[^0-9]+&quot;, &quot;&quot;, codent)), gsub(&quot;[0-9]+&quot;, &quot;&quot;, codent)) geoentidades$COD_ENT&lt;-codent geoentidades &lt;-subset(geoentidades,geoentidades$NOM_ENT %in% c(params$entidad)) codent&lt;-geoentidades$COD_ENT rutamc&lt;-&quot;D:/Documents/Claudia/Midropbox/Investigacion y escritos/Censo2020/889463807469_s/&quot; filename&lt;-geoentidades$ARCHENT filemun&lt;-paste0(geoentidades$COD_ENT,&quot;mun&quot;) fileloc&lt;-paste0(geoentidades$COD_ENT,&quot;a&quot;) filemza&lt;-paste0(geoentidades$COD_ENT,&quot;m&quot;) url&lt;-paste0(rutamc,filename,&quot;.zip&quot;) temp2 &lt;- tempfile() unzip(url, exdir = temp2) rut&lt;-file.path(temp2) rutamun&lt;-paste0(rut,&quot;/conjunto_de_datos&quot;) basemapamun &lt;- readOGR(rutamun,filemun, use_iconv = TRUE, encoding = &quot;latin1&quot;) ## OGR data source with driver: ESRI Shapefile ## Source: &quot;C:\\Users\\Claudia.Guerrero\\AppData\\Local\\Temp\\RtmpmWrTxw\\file1d388846591\\conjunto_de_datos&quot;, layer: &quot;05mun&quot; ## with 38 features ## It has 4 fields snummun&lt;-sprintf(&quot;%03d%s&quot;, as.numeric(gsub(&quot;[^0-9]+&quot;, &quot;&quot;, nummun)), gsub(&quot;[0-9]+&quot;, &quot;&quot;, nummun)) basemapamun&lt;-subset(basemapamun,basemapamun$CVE_MUN %in% c(snummun)) basemapaloc &lt;- readOGR(rutamun,fileloc, use_iconv = TRUE, encoding = &quot;latin1&quot;) ## OGR data source with driver: ESRI Shapefile ## Source: &quot;C:\\Users\\Claudia.Guerrero\\AppData\\Local\\Temp\\RtmpmWrTxw\\file1d388846591\\conjunto_de_datos&quot;, layer: &quot;05a&quot; ## with 1882 features ## It has 5 fields basemapaloc&lt;-subset(basemapaloc,basemapaloc$CVE_MUN %in% c(snummun)) basemapamza &lt;- readOGR(rutamun,filemza, use_iconv = TRUE, encoding = &quot;latin1&quot;) ## OGR data source with driver: ESRI Shapefile ## Source: &quot;C:\\Users\\Claudia.Guerrero\\AppData\\Local\\Temp\\RtmpmWrTxw\\file1d388846591\\conjunto_de_datos&quot;, layer: &quot;05m&quot; ## with 75827 features ## It has 8 fields basemapamza&lt;-subset(basemapamza,basemapamza$CVE_MUN %in% c(snummun)) rutvar&lt;-&quot;D:/Documents/Claudia/Midropbox/Investigacion y escritos&quot; variablescensales&lt;-read.csv(paste0(rutvar,&quot;/Censo2020/&quot;,&quot;variablescensales.csv&quot;),header=TRUE, sep=&quot;,&quot;,encoding=&quot;UTF-8&quot;) 8.2 Importación de datos censales En el sitio del INEGI se encuentran los resultados del CENSO 2020 para cada una de las entidades de la población https://www.inegi.org.mx/programas/ccpv/2020/default.html#Datos_abiertos Principales resultados por AGEB y manzana urbana Ejemplo. Aguascaliente https://www.inegi.org.mx/contenidos/programas/ccpv/2020/datosabiertos/ageb_manzana/ageb_mza_urbana_01_cpv2020_csv.zip Para recuperar los datos censales a nivel estatal: En el archivo se registra la población total de la entidad cuando en el nombre de la localidad aparece la leyenda Total de la Entidad codent&lt;-geoentidades$COD_ENT url&lt;-paste0(&quot;https://www.inegi.org.mx/contenidos/programas/ccpv/2020/datosabiertos/ageb_manzana/ageb_mza_urbana_&quot;,codent,&quot;_cpv2020_csv.zip&quot;) temp &lt;- tempfile() temp2 &lt;- tempfile() download.file(url, temp) unzip(zipfile = temp, exdir = temp2) rut&lt;-file.path(temp2) filename&lt;-paste0(rut,&quot;/&quot;,&quot;ageb_mza_urbana_&quot;,codent,&quot;_cpv2020&quot;,&quot;/&quot;,&quot;conjunto_de_datos&quot;,&quot;/&quot;,&quot;conjunto_de_datos_ageb_urbana_&quot;,codent,&quot;_cpv2020.csv&quot;) censonal&lt;- read.csv(filename,header=TRUE, sep=&quot;,&quot;,encoding=&quot;UTF-8&quot;) names(censonal)[1] &lt;- &quot;CVE_ENT&quot; #Datos de toda la entidad uso del campo nom_loc para identificar los valores de las variables a nivel estatal censonal &lt;-subset(censonal,censonal$NOM_ENT %in% c(params$entidad)) censonal &lt;-subset(censonal,censonal$MUN %in% c(nummun)) `%notin%` &lt;- Negate(`%in%`) censonal &lt;-censonal[censonal$AGEB %notin% c(&quot;0000&quot;),] codent&lt;-substr(censonal$CVE_ENT,1,2) codent&lt;-sprintf(&quot;%02d%s&quot;, as.numeric(gsub(&quot;[^0-9]+&quot;, &quot;&quot;, codent)), gsub(&quot;[0-9]+&quot;, &quot;&quot;, codent)) codmun&lt;-substr(censonal$MUN,1,3) codmun&lt;-sprintf(&quot;%03d%s&quot;, as.numeric(gsub(&quot;[^0-9]+&quot;, &quot;&quot;, codmun)), gsub(&quot;[0-9]+&quot;, &quot;&quot;, codmun)) codloc&lt;-substr(censonal$LOC,1,4) codloc&lt;-sprintf(&quot;%04d%s&quot;, as.numeric(gsub(&quot;[^0-9]+&quot;, &quot;&quot;, codloc)), gsub(&quot;[0-9]+&quot;, &quot;&quot;, codloc)) codageb&lt;-substr(censonal$AGEB,1,4) codmza&lt;-substr(censonal$MZA,1,3) codmza&lt;-sprintf(&quot;%03d%s&quot;, as.numeric(gsub(&quot;[^0-9]+&quot;, &quot;&quot;, codmza)), gsub(&quot;[0-9]+&quot;, &quot;&quot;, codmza)) censonal$CVEGEO&lt;-paste0(codent,codmun,codloc,codageb,codmza) # censonal &lt;-subset(censonal,censonal$NOM_ENT %in% #c(params$entidad)) #Ahora el mapa tiene el dato de las 198 variables del censo #Conversión a número cols = c(11:229) censonal[,cols] %&lt;&gt;% lapply(function(x) as.integer(as.character(x))) #censonal$CVEGEO censonal[,cols] %&lt;&gt;% lapply(function(x) x/censonal$POBTOT) basemapa&lt;-merge(basemapamza,censonal, by=&quot;CVEGEO&quot;, all.x =TRUE) La selección de la zona se realiza en el sitio del INEGI En la opción de los Servicios y Espacio y datos de México https://www.inegi.org.mx/app/mapa/espacioydatos/# Se utiliza la herramienta del polígono para seleccionar el área que se quiere estudiar y los distintos niveles de zoom son los que dan las capas disponibles. Para la capa de las manzanas se requiere un zoom de 16 y se puede solicitar que el archivo se enviado a un correo electrónico. El archivo en cuestión se descomprime en la máquina personal y desde ahí se lee el el que contiene la capa correspondiente Una vez que se lee el mapa que ya habíamos creado con los valores cartográficos y censales para la entidad y municipio seleccionado en los parámetros, se obtiene de él el subconjunto espacial de la zona seleccionada, como un subconjunto de la matriz completa rutaz&lt;-&quot;D:/Documents/Claudia/Midropbox/Investigacion y escritos/Censo2020/zona&quot; filez&lt;-&quot;INEGI_Manzanas_&quot; basemapaz &lt;- readOGR(rutaz,filez, use_iconv = TRUE, encoding = &quot;latin1&quot;) ## OGR data source with driver: ESRI Shapefile ## Source: &quot;D:\\Documents\\Claudia\\Midropbox\\Investigacion y escritos\\Censo2020\\zona&quot;, layer: &quot;INEGI_Manzanas_&quot; ## with 100 features ## It has 80 fields basemapaz &lt;- spTransform(basemapaz, CRS(proj4string(basemapa))) # transform CRS mapazon &lt;- basemapa[basemapaz, ] basemapa&lt;-mapazon 8.3 Variables en zona seleccionada Torreón P_60YMAS Población de 60 años y más El estilo fisher crea grupos con la máxima homogeneidad 8.4 Video Este proceso se detalla en el siguiente video "],["indicador-cartografiado-por-manzana.html", "Capítulo 9 Indicador cartografiado por manzana 9.1 Importación de datos cartográficos 9.2 Importación de datos censales 9.3 Indicador en zona seleccionada 9.4 Video", " Capítulo 9 Indicador cartografiado por manzana El siguiente texto ejemplifica la ejecución del código seleccionando la variable que se quiere estudiar  title: Indicador cartografiado por manzana author: Claudia Guerrero S date: 6/04/2021 output: html_document: df_print: paged pdf_document: default params: # Render Function: # estilo: label: Estilo value: jenks input: select choices: [pretty,equal,quantile,sd,kmeans,jenks,fisher] indicad: label: Indicador value: Indenv65 input: select choices: [Indenv65,Indenv60,Relapoyopot,Reladepdem65,Reldepdem60] entidad: label: Entidad Federativa value: Coahuila de Zaragoza input: select choices: [Aguascalientes,Baja California,Baja California Sur,Campeche,Coahuila de Zaragoza,Colima,Chiapas,Chihuahua,Ciudad de México,Durango,Guanajuato,Guerrero,Hidalgo,Jalisco,México,Michoacán de Ocampo,Morelos,Nayarit,Nuevo León,Oaxaca,Puebla,Querétaro,Quintana Roo,San Luis Potosí,Sinaloa,Sonora,Tabasco,Tamaulipas,Tlaxcala,Veracruz de Ignacio de la Llave,Yucatán,Zacatecas] municipio: label: Municipio value: Torreón editor_options: markdown: wrap: 72  9.1 Importación de datos cartográficos https://www.inegi.org.mx/contenidos/productos/prod_serv/contenidos/espanol/bvinegi/productos/geografia/marcogeo/889463807469_s.zip Censo de Población y Vivienda 2020 2020 2.65 GB https://inegi.org.mx/contenidos/productos//prod_serv/contenidos/espanol/bvinegi/productos/geografia/marcogeo/889463807469_s.zip Ficha de información https://inegi.org.mx/app/biblioteca/ficha.html?upc=889463807469 Se descarga y se descomprime localmente Se crea una carpeta para los datos geográficos #La ruta para el mapa de México se toma del Marcogeostadístico nacional rutam&lt;-&quot;D:/Documents/Claudia/Midropbox/Investigacion y escritos/Marcogeoestadisticonacional/mg_sep2019_integrado/conjunto_de_datos&quot; rutamc&lt;-&quot;D:/Documents/Claudia/Midropbox/Investigacion y escritos/Censo2020/&quot; geoentidades&lt;-read.csv(paste0(rutamc,&quot;marcogeoentidad.csv&quot;),header=TRUE, sep=&quot;,&quot;,encoding=&quot;UTF-8&quot;) municipios&lt;-read.csv(paste0(rutamc,&quot;municipios.csv&quot;),header=TRUE, sep=&quot;,&quot;,encoding=&quot;latin&quot;) municipios &lt;-subset(municipios,municipios$NOM_ENT %in% c(params$entidad)) municipios &lt;-subset(municipios,municipios$NOM_MUN %in% c(params$municipio)) titulmun&lt;-municipios$NOM_MUN nummun&lt;-municipios$MUN rutamc&lt;-&quot;D:/Documents/Claudia/Midropbox/Investigacion y escritos/Censo2020/889463807469_s&quot; codent&lt;-substr(geoentidades$NUM_ENT,1,2) codent&lt;-sprintf(&quot;%02d%s&quot;, as.numeric(gsub(&quot;[^0-9]+&quot;, &quot;&quot;, codent)), gsub(&quot;[0-9]+&quot;, &quot;&quot;, codent)) geoentidades$COD_ENT&lt;-codent geoentidades &lt;-subset(geoentidades,geoentidades$NOM_ENT %in% c(params$entidad)) codent&lt;-geoentidades$COD_ENT rutamc&lt;-&quot;D:/Documents/Claudia/Midropbox/Investigacion y escritos/Censo2020/889463807469_s/&quot; filename&lt;-geoentidades$ARCHENT filemun&lt;-paste0(geoentidades$COD_ENT,&quot;mun&quot;) fileloc&lt;-paste0(geoentidades$COD_ENT,&quot;a&quot;) filemza&lt;-paste0(geoentidades$COD_ENT,&quot;m&quot;) url&lt;-paste0(rutamc,filename,&quot;.zip&quot;) temp2 &lt;- tempfile() unzip(url, exdir = temp2) rut&lt;-file.path(temp2) rutamun&lt;-paste0(rut,&quot;/conjunto_de_datos&quot;) basemapamun &lt;- readOGR(rutamun,filemun, use_iconv = TRUE, encoding = &quot;latin1&quot;) ## OGR data source with driver: ESRI Shapefile ## Source: &quot;C:\\Users\\Claudia.Guerrero\\AppData\\Local\\Temp\\RtmpmWrTxw\\file1d387a2b2354\\conjunto_de_datos&quot;, layer: &quot;05mun&quot; ## with 38 features ## It has 4 fields snummun&lt;-sprintf(&quot;%03d%s&quot;, as.numeric(gsub(&quot;[^0-9]+&quot;, &quot;&quot;, nummun)), gsub(&quot;[0-9]+&quot;, &quot;&quot;, nummun)) basemapamun&lt;-subset(basemapamun,basemapamun$CVE_MUN %in% c(snummun)) basemapaloc &lt;- readOGR(rutamun,fileloc, use_iconv = TRUE, encoding = &quot;latin1&quot;) ## OGR data source with driver: ESRI Shapefile ## Source: &quot;C:\\Users\\Claudia.Guerrero\\AppData\\Local\\Temp\\RtmpmWrTxw\\file1d387a2b2354\\conjunto_de_datos&quot;, layer: &quot;05a&quot; ## with 1882 features ## It has 5 fields basemapaloc&lt;-subset(basemapaloc,basemapaloc$CVE_MUN %in% c(snummun)) basemapamza &lt;- readOGR(rutamun,filemza, use_iconv = TRUE, encoding = &quot;latin1&quot;) ## OGR data source with driver: ESRI Shapefile ## Source: &quot;C:\\Users\\Claudia.Guerrero\\AppData\\Local\\Temp\\RtmpmWrTxw\\file1d387a2b2354\\conjunto_de_datos&quot;, layer: &quot;05m&quot; ## with 75827 features ## It has 8 fields basemapamza&lt;-subset(basemapamza,basemapamza$CVE_MUN %in% c(snummun)) rutvar&lt;-&quot;D:/Documents/Claudia/Midropbox/Investigacion y escritos&quot; variablescensales&lt;-read.csv(paste0(rutvar,&quot;/Censo2020/&quot;,&quot;variablescensales.csv&quot;),header=TRUE, sep=&quot;,&quot;,encoding=&quot;UTF-8&quot;) 9.2 Importación de datos censales En el sitio del INEGI se encuentran los resultados del CENSO 2020 para cada una de las entidades de la población https://www.inegi.org.mx/programas/ccpv/2020/default.html#Datos_abiertos Principales resultados por AGEB y manzana urbana Ejemplo. Aguascalientes https://www.inegi.org.mx/contenidos/programas/ccpv/2020/datosabiertos/ageb_manzana/ageb_mza_urbana_01_cpv2020_csv.zip Para recuperar los datos censales a nivel estatal: En el archivo se registra la población total de la entidad cuando en el nombre de la localidad aparece la leyenda Total de la Entidad codent&lt;-geoentidades$COD_ENT url&lt;-paste0(&quot;https://www.inegi.org.mx/contenidos/programas/ccpv/2020/datosabiertos/ageb_manzana/ageb_mza_urbana_&quot;,codent,&quot;_cpv2020_csv.zip&quot;) temp &lt;- tempfile() temp2 &lt;- tempfile() download.file(url, temp) unzip(zipfile = temp, exdir = temp2) rut&lt;-file.path(temp2) filename&lt;-paste0(rut,&quot;/&quot;,&quot;ageb_mza_urbana_&quot;,codent,&quot;_cpv2020&quot;,&quot;/&quot;,&quot;conjunto_de_datos&quot;,&quot;/&quot;,&quot;conjunto_de_datos_ageb_urbana_&quot;,codent,&quot;_cpv2020.csv&quot;) censonal&lt;- read.csv(filename,header=TRUE, sep=&quot;,&quot;,encoding=&quot;UTF-8&quot;) names(censonal)[1] &lt;- &quot;CVE_ENT&quot; #Datos de toda la entidad uso del campo nom_loc para identificar los valores de las variables a nivel estatal censonal &lt;-subset(censonal,censonal$NOM_ENT %in% c(params$entidad)) censonal &lt;-subset(censonal,censonal$MUN %in% c(nummun)) `%notin%` &lt;- Negate(`%in%`) censonal &lt;-censonal[censonal$AGEB %notin% c(&quot;0000&quot;),] codent&lt;-substr(censonal$CVE_ENT,1,2) codent&lt;-sprintf(&quot;%02d%s&quot;, as.numeric(gsub(&quot;[^0-9]+&quot;, &quot;&quot;, codent)), gsub(&quot;[0-9]+&quot;, &quot;&quot;, codent)) codmun&lt;-substr(censonal$MUN,1,3) codmun&lt;-sprintf(&quot;%03d%s&quot;, as.numeric(gsub(&quot;[^0-9]+&quot;, &quot;&quot;, codmun)), gsub(&quot;[0-9]+&quot;, &quot;&quot;, codmun)) codloc&lt;-substr(censonal$LOC,1,4) codloc&lt;-sprintf(&quot;%04d%s&quot;, as.numeric(gsub(&quot;[^0-9]+&quot;, &quot;&quot;, codloc)), gsub(&quot;[0-9]+&quot;, &quot;&quot;, codloc)) codageb&lt;-substr(censonal$AGEB,1,4) codmza&lt;-substr(censonal$MZA,1,3) codmza&lt;-sprintf(&quot;%03d%s&quot;, as.numeric(gsub(&quot;[^0-9]+&quot;, &quot;&quot;, codmza)), gsub(&quot;[0-9]+&quot;, &quot;&quot;, codmza)) censonal$CVEGEO&lt;-paste0(codent,codmun,codloc,codageb,codmza) # censonal &lt;-subset(censonal,censonal$NOM_ENT %in% #c(params$entidad)) #Ahora el mapa tiene el dato de las 198 variables del censo #Conversión a número cols = c(11:229) censonal[,cols] %&lt;&gt;% lapply(function(x) as.integer(as.character(x))) #censonal$CVEGEO censonal[,cols] %&lt;&gt;% lapply(function(x) x/censonal$POBTOT) basemapa&lt;-merge(basemapamza,censonal, by=&quot;CVEGEO&quot;, all.x =TRUE) La selección de la zona se realiza en el sitio del INEGI En la opción de los Servicios y Espacio y datos de México https://www.inegi.org.mx/app/mapa/espacioydatos/# Se utiliza la herramienta del polígono para seleccionar el área que se quiere estudiar y los distintos niveles de zoom son los que dan las capas disponibles. Para la capa de las manzanas se requiere un zoom de 16 y se puede solicitar que el archivo se enviado a un correo electrónico. El archivo en cuestión se descomprime en la máquina personal y desde ahí se lee el el que contiene la capa correspondiente Una vez que se lee el mapa que ya habíamos creado con los valores cartográficos y censales para la entidad y municipio seleccionado en los parámetros, se obtiene de él el subconjunto espacial de la zona seleccionada, como un subconjunto de la matriz completa rutaz&lt;-&quot;D:/Documents/Claudia/Midropbox/Investigacion y escritos/Censo2020/zona&quot; filez&lt;-&quot;INEGI_Manzanas_&quot; basemapaz &lt;- readOGR(rutaz,filez, use_iconv = TRUE, encoding = &quot;latin1&quot;) ## OGR data source with driver: ESRI Shapefile ## Source: &quot;D:\\Documents\\Claudia\\Midropbox\\Investigacion y escritos\\Censo2020\\zona&quot;, layer: &quot;INEGI_Manzanas_&quot; ## with 100 features ## It has 80 fields basemapaz &lt;- spTransform(basemapaz, CRS(proj4string(basemapa))) # transform CRS #mapazon &lt;- basemapa[basemapaz, ] #basemapa&lt;-mapazon 9.3 Indicador en zona seleccionada Torreón Índice de envejecimiento 65 POB65ymás/Pob0a14 El estilo fisher crea grupos con la máxima homogeneidad 9.4 Video "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
